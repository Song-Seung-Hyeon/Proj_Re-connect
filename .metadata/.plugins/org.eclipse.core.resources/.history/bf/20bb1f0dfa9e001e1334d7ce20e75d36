<%@ page import="java.sql.*"%>
<%@ page contentType="text/html;charset=UTF-8" language="java"%>
<%@ page import="java.io.*,java.util.*"%>
<%@ page import="javax.servlet.*,javax.servlet.http.*"%>
<%request.setCharacterEncoding("utf-8");%>
<%@ page import="org.json.JSONObject" %>

<%
// POST 방식으로 받은 데이터 처리
String userId = request.getParameter("userId");

// MySQL 연결 정보
String url = "jdbc:mysql://localhost:3306/your_database";
String username = "your_username";
String password = "your_password";

JSONObject jsonResponse = new JSONObject();

try {
    Class.forName("com.mysql.jdbc.Driver");
    Connection conn = DriverManager.getConnection(url, username, password);

    // 아이디 중복 확인 쿼리
    String query = "SELECT COUNT(*) AS count FROM user_list WHERE user_id = ?";
    PreparedStatement pstmt = conn.prepareStatement(query);
    pstmt.setString(1, userId);

    ResultSet rs = pstmt.executeQuery();
    if (rs.next()) {
        int count = rs.getInt("count");
        if (count > 0) {
            jsonResponse.put("exists", true); // 중복된 아이디가 존재함
        } else {
            jsonResponse.put("exists", false); // 중복된 아이디가 없음
        }
    }

    rs.close();
    pstmt.close();
    conn.close();
} catch (Exception e) {
    e.printStackTrace();
    jsonResponse.put("error", "Database error");
}

response.setContentType("application/json");
response.setCharacterEncoding("UTF-8");
response.getWriter().write(jsonResponse.toString());
%>
